--[[
getgenv().enabled=true
getgenv().enabled2=true
getgenv().uselocalplayer=false
loadstring(game:HttpGet("https://raw.githubusercontent.com/Vcsk/RobloxScripts/main/Highlight-ESP.lua"))()
]]

local holder=game.CoreGui:FindFirstChild("ESPHolder") or Instance.new("Folder")
if enabled==false or getgenv().enabled2=false then
 holder:Destroy()
end

if holder.Name=="Folder" then
 holder.Name="ESPHolder"
 holder.Parent=game.CoreGui
end

if getgenv().enabled==true then 
 getgenv().enabled=false
 getgenv().enabled=true
end

if getgenv().enabled2==true then 
 getgenv().enabled2=false
 getgenv().enabled2=true
end

game:GetService("RunService").Heartbeat:Connect(function()
 if getgenv().enabled then
  task.wait()
  holder:FindFirstChild(game.Players.LocalPlayer.Name):Destroy()
  for _,v in pairs(game.Players:GetChildren()) do
   local chr=v.Character
   if chr~=nil then
    local esp=holder:FindFirstChild(v.Name) or Instance.new("Highlight")
    esp.Name=v.Name
    esp.Parent=holder
    esp.FillColor=v.TeamColor.Color or Color3.new(1,1,1)
    esp.OutlineColor=v.TeamColor.Color or Color3.new(1,1,1)
    esp.FillTransparency=0.9
    esp.OutlineTransparency=0
    esp.Adornee=chr
    esp.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop
   end
  end
 end
end
end)

local espObjects={}
local function applyESP(character)
if character and character:FindFirstChild("HumanoidRootPart") then
 local board=Instance.new("BillboardGui",character)
 board.Size=UDim2.new(0,180,0,40)
 board.Adornee=character:FindFirstChild("Head")
 board.StudsOffset=Vector3.new(0,2,0)
 board.AlwaysOnTop=true
 local text=Instance.new("TextLabel",board)
 text.Size=UDim2.new(1,0,1,0)
 text.Text="Loading..."
 text.TextColor3=Color3.new(1,1,1)
 text.TextSize=14
 text.Font="GothamBold"
 text.TextStrokeTransparency=0.5
 text.BackgroundTransparency=1
 espObjects[character]={highlight,board,text}
 end
end

local function updateESP()
local plr=game.Players
for _,plr in pairs(game.Players:GetPlayers()) do
 if plr~=game.Players.LocalPlayer and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
  local char=game.Players.LocalPlayer.Character
  local rootPart=char:FindFirstChild("HumanoidRootPart")
  local humanoid=char:FindFirstChild("Humanoid")
  local espData=espObjects[char]
  if rootPart and humanoid and espData then
   local distance=(rootPart.Position-game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
   local health=math.floor(game.Players.LocalPlayer.Character.Humanoid.Health)
   local maxHealth=math.floor(game.Players.LocalPlayer.Character.Humanoid.MaxHealth)
   espData[3].Text=string.format("%.1fm | %d/%d HP | %s",distance,health,maxHealth,game.Players.LocalPlayer.DisplayName)
   end
  end
 end
end

local function refreshESP()
local plr=game.Players
for _,data in pairs(espObjects) do
 for _,obj in pairs(data) do
  obj:Destroy()
 end
end
espObjects={}
for _,plr in pairs(game.Players:GetPlayers()) do
 if plr~=game.Players.LocalPlayer and game.Players.LocalPlayer.Character then
  applyESP(game.Players.LocalPlayer.Character)
  end
 end
end

if getgenv().enabled2 then
 refreshESP()
 rs.RenderStepped:Connect(function()
  if getgenv().enabled2 then
   updateESP()
  end
 end)
end